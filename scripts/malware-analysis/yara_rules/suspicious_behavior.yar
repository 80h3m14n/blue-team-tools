import "pe"

rule Example_Malware_Detection
{
    meta:
        author = "Ryan"
        description = "Detects example malware pattern in binaries"
        date = "2025-08-16"
        version = "1.0"

    strings:
        $str1 = "malicious_function" ascii wide
        $str2 = { 6A 40 68 00 30 00 00 6A 14 8D 91 }   // example hex pattern
        $str3 = "cmd.exe /c" ascii
        $url  = "http://evil.example.com" ascii

    condition:
        any of ($str*) or $url
		pe.imports("kernel32.dll", "VirtualAlloc")
